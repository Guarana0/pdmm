{% extends 'base.html' %}
{% load static %}
{% block title %}{{ autor.slug|title }}{% endblock %}
{% block description %}Detalhes do Autor Modernista Mineiro{% endblock %}
{% block keywords %}Autor, Modernismo, Literatura{% endblock %}

{% block content %}
<main class="bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-200">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12">

    <!-- Cabeçalho do Autor: Nome e Tagline -->
    <header class="text-center mb-8 md:mb-12">
      <h1 class="text-4xl md:text-5xl font-extrabold text-gray-900 dark:text-white tracking-tight">
        {{ autor.nome }} {{ autor.sobrenome }}
      </h1>
      <p class="mt-2 text-lg md:text-xl text-gray-600 dark:text-gray-400">
        Contista, romancista e poeta do Modernismo
      </p>
    </header>

    <article>
      <!-- Seção Principal: Biografia com Imagem -->
      <section class="flex flex-col md:flex-row gap-8 items-center md:items-start">
        <!-- Imagem do Autor -->
        <div class="flex-shrink-0">
          {% if autor.foto %}
          <img 
            src="{{ autor.foto.url }}"
            alt="Retrato de {{ autor.nome }} {{ autor.sobrenome }}" 
            class="w-40 h-40 md:w-56 md:h-56 object-cover rounded-lg border-4 border-gray-200 dark:border-gray-700 shadow-lg"
          />
          {% else %}
          <div class="w-40 h-40 md:w-56 md:h-56 bg-gray-200 dark:bg-gray-700 rounded-lg border-4 border-gray-200 dark:border-gray-700 shadow-lg flex items-center justify-center">
            <span class="text-gray-500 dark:text-gray-400">Sem foto</span>
          </div>
          {% endif %}
        </div>

        <!-- Texto da Biografia -->
        <div class="text-base text-gray-700 dark:text-gray-300 space-y-4 text-justify leading-relaxed">
          <p>{{ autor.biografia|linebreaks }}</p>
        </div>
      </section>
      
      <!-- Seção de Obras (Bibliografia) -->
      <section class="mt-12 md:mt-16">
        <h2 class="text-2xl md:text-3xl font-bold mb-6 text-center text-gray-900 dark:text-white border-b-2 border-gray-200 dark:border-gray-700 pb-3">
          Principais Obras
        </h2>
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
          {% for livro in autor.livros.all %}
          <div class="bg-gray-50 dark:bg-gray-800 p-6 rounded-lg border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-shadow duration-300">
            <h3 class="font-bold text-lg text-gray-900 dark:text-white">{{ livro.titulo }}</h3>
            <p class="text-sm text-gray-600 dark:text-gray-400">{{ livro.get_genero_display }} ({{ livro.ano_publicacao }})</p>
          </div>
          {% empty %}
          <div class="col-span-full text-center text-gray-600 dark:text-gray-400">
              <p>Nenhuma obra cadastrada para este autor.</p>
          </div>
          {% endfor %}
        </div>
      </section>

      <!-- Seção de Referências -->
      <section class="mt-12 md:mt-16">
        <h2 class="text-2xl md:text-3xl font-bold mb-6 text-gray-900 dark:text-white">
          Referências Bibliográficas
        </h2>
        <div class="space-y-6">
          {% for ref in autor.referencias.all %}
          <div class="bg-gray-50 dark:bg-gray-800 p-6 rounded-lg border border-gray-200 dark:border-gray-700 hover:shadow-md transition-shadow duration-300">
            <div class="space-y-3">
              <div class="border-l-4 border-blue-500 pl-4">
                <p class="text-sm md:text-base text-gray-700 dark:text-gray-300 leading-relaxed">
                  {{ ref.abnt_format|safe }}
                </p>
              </div>
              
              {% if ref.descricao %}
              <div class="mt-3 p-3 bg-blue-50 dark:bg-blue-900/20 rounded border-l-2 border-blue-300 dark:border-blue-600">
                <p class="text-sm text-gray-600 dark:text-gray-400 italic">
                  {{ ref.descricao }}
                </p>
              </div>
              {% endif %}
              
              {% if ref.tem_link and ref.link %}
              <div class="flex items-center justify-between mt-4">
                <a href="{{ ref.link }}" target="_blank" rel="noopener noreferrer" 
                   class="inline-flex items-center px-4 py-2 text-sm font-medium text-blue-600 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-700 rounded-md hover:bg-blue-100 dark:hover:bg-blue-900/30 transition-colors duration-200">
                  <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path>
                  </svg>
                  Acessar fonte
                </a>
                {% if ref.data_acesso %}
                <span class="text-xs text-gray-500 dark:text-gray-400">
                  Último acesso: {{ ref.data_acesso|date:"d/m/Y" }}
                </span>
                {% endif %}
              </div>
              {% endif %}
            </div>
          </div>
          {% empty %}
          <div class="bg-gray-50 dark:bg-gray-800 p-8 rounded-lg border-2 border-dashed border-gray-300 dark:border-gray-600 text-center">
            <svg class="mx-auto h-12 w-12 text-gray-400 dark:text-gray-500 mb-4" fill="none" stroke="currentColor" viewBox="0 0 48 48">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 14v20c0 4.418 7.163 8 16 8 1.381 0 2.721-.087 4-.252M8 14c0 4.418 7.163 8 16 8s16-3.582 16-8M8 14c0-4.418 7.163-8 16-8s16 3.582 16 8m0 0v14m-16-4h.01M32 18h.01"></path>
            </svg>
            <p class="text-gray-600 dark:text-gray-400 font-medium">Nenhuma referência bibliográfica cadastrada para este autor.</p>
            <p class="text-sm text-gray-500 dark:text-gray-500 mt-1">As referências aparecerão aqui quando forem adicionadas.</p>
          </div>
          {% endfor %}
        </div>
      </section>
    </article>

  </div>
</main>
{% endblock %}